{% extends 'base.html' %}

{% block content %}
<script>
    function updateMajors() {
        const department = document.getElementById("d").value;
        const majorDropdown = document.getElementById("m");

        const majors = {
            "فنی و مهندسی": ["مهندسی برق", "مهندسی کامپیوتر", "مهندسی عمران", "مهندسی مکانیک"],
            "علوم پایه": ["ریاضیات", "فیزیک", "شیمی", "زیست‌شناسی"],
            "دامپزشکی": ["دامپزشکی عمومی", "تخصصی"],
            "ادبیات و اقتصاد": ["ادبیات فارسی", "علوم اقتصادی", "مدیریت"]
        };

        // Clear existing options
        majorDropdown.innerHTML = "<option value='' disabled selected>انتخاب کنید</option>";

        // Populate with options based on selected department
        if (department && majors[department]) {
            majors[department].forEach(function(maj) {
                const option = document.createElement("option");
                option.value = maj;
                option.text = maj;
                majorDropdown.add(option);
            });
        }
    }

    // Call the function when the page loads
    document.addEventListener('DOMContentLoaded', (event) => {
        document.getElementById('d').addEventListener('change', updateMajors);
    });

    function validateForm() {
        var studentId = document.getElementById("st").value;
        var postalCode = document.getElementById("postalcode").value;
        var phoneNumber = document.getElementById("cp").value;
        var nationalId = document.getElementById("nid").value;

        var errorField1 = document.getElementById("error-message1");
        var errorField2 = document.getElementById("error-message2");
        var errorField3 = document.getElementById("error-message3");
        var errorField4 = document.getElementById("error-message4");

        var valid = true;

        if (studentId.length !== 11) {
            errorField1.innerHTML = "شماره دانشجویی باید دقیقاً 11 رقم باشد.";
            valid = false;
        } else {
            errorField1.innerHTML = "";
        }

        if (postalCode.length !== 10) {
            errorField2.innerHTML = "کد پستی باید 10 رقم باشد.";
            valid = false;
        } else {
            errorField2.innerHTML = "";
        }

        if (phoneNumber.length !== 11) {
            errorField3.innerHTML = "شماره تلفن باید 11 رقم باشد.";
            valid = false;
        } else {
            errorField3.innerHTML = "";
        }

        if (nationalId.length !== 10) {
            errorField4.innerHTML = "کد ملی باید 10 رقم باشد.";
            valid = false;
        } else {
            errorField4.innerHTML = "";
        }

        return valid;
    }
</script>

<form action="/update_student/{{ user.id }}" method="post" onsubmit="return validateForm()">
    <div class="mb-3">
        <label>STID</label>
        <input type="text" name="st" placeholder="STID" class="form-control" value="{{ user.st }}" />
    </div>
    <div class="mb-3">
        <label>FName</label>
        <input type="text" name="fn" placeholder="FName" class="form-control" value="{{ user.fn }}" />
    </div>
    <div class="mb-3">
        <label>LName</label>
        <input type="text" name="ln" placeholder="LName" class="form-control" value="{{ user.ln }}" />
    </div>
    <div class="mb-3">
        <label>Father</label>
        <input type="text" name="f" placeholder="Father" class="form-control" value="{{ user.f }}" />
    </div>
    <div class="mb-3">
        <label>Birth</label>
        <input type="text" name="birth" placeholder="Birth" class="form-control" value="{{ user.birth }}" />
    </div>
    <div class="mb-3">
        <label>IDS</label>
        <input type="text" name="ids" placeholder="IDS" class="form-control" value="{{ user.ids }}" />
    </div>
    <div class="mb-3">
        <label>Born City</label>
        <select id="borncity" name="borncity" class="form-control" required autocomplete="off">
            <option value="" disabled selected>انتخاب کنید</option>
            <option value="آبادان">آبادان</option>
            <option value="اراک">اراک</option>
            <option value="اصفهان">اصفهان</option>
            <option value="اهواز">اهواز</option>
            <option value="ایلام">ایلام</option>
            <option value="بابل">بابل</option>
            <option value="بجنورد">بجنورد</option>
            <option value="بندرعباس">بندرعباس</option>
            <option value="بندرانزلی">بندرانزلی</option>
            <option value="بوشهر">بوشهر</option>
            <option value="پارس‌آباد">پارس‌آباد</option>
            <option value="پارسیان">پارسیان</option>
            <option value="پلدختر">پلدختر</option>
            <option value="پیشوا">پیشوا</option>
            <option value="تبریز">تبریز</option>
            <option value="تهران">تهران</option>
            <option value="جیرفت">جیرفت</option>
            <option value="خرم‌آباد">خرم‌آباد</option>
            <option value="رشت">رشت</option>
            <option value="زاهدان">زاهدان</option>
            <option value="زنجان">زنجان</option>
            <option value="ساوه">ساوه</option>
            <option value="سنندج">سنندج</option>
            <option value="سبزوار">سبزوار</option>
            <option value="سمنان">سمنان</option>
            <option value="شهرکرد">شهرکرد</option>
            <option value="شیراز">شیراز</option>
            <option value="قزوین">قزوین</option>
            <option value="قم">قم</option>
            <option value="کرج">کرج</option>
            <option value="کرمان">کرمان</option>
            <option value="کرمانشاه">کرمانشاه</option>
            <option value="کاشان">کاشان</option>
            <option value="کاشمر">کاشمر</option>
            <option value="گرگان">گرگان</option>
            <option value="گلستان">گلستان</option>
            <option value="مازندران">مازندران</option>
            <option value="مشهد">مشهد</option>
            <option value="مهران">مهران</option>
            <option value="مهریز">مهریز</option>
            <option value="میبد">میبد</option>
            <option value="نی‌ریز">نی‌ریز</option>
            <option value="نجف‌آباد">نجف‌آباد</option>
            <option value="نهران">نهران</option>
            <option value="نیشابور">نیشابور</option>
            <option value="همدان">همدان</option>
            <option value="یاسوج">یاسوج</option>
            <option value="یزد">یزد</option>
            
        </select>
    </div>
    <div class="mb-3">
        <label>Address</label>
        <input type="text" name="address" placeholder="Address" class="form-control" value="{{ user.address }}" />
    </div>
    <div class="mb-3">
        <label>Postal Code</label>
        <input type="text" id="postalcode" name="postalcode" placeholder="Postal Code" class="form-control" value="{{ user.postalcode }}" />
        <div id="error-message2" class="text-danger"></div>
    </div>
    <div class="mb-3">
        <label>Cell Phone</label>
        <input type="text" id="cp" name="cp" placeholder="Cell Phone" class="form-control" value="{{ user.cp }}" />
        <div id="error-message3" class="text-danger"></div>
    </div>
    <div class="mb-3">
        <label>Home Phone</label>
        <select id="hp" name="hp" class="form-control" required autocomplete="off">
            <option value="" disabled selected>کد</option>
            <option value="011">011 - ساری</option>
            <option value="013">013 - رشت</option>
            <option value="017">017 - گرگان</option>
            <option value="021">021 - تهران</option>
            <option value="023">023 - سمنان</option>
            <option value="024">024 - زنجان</option>
            <option value="025">025 - قم</option>
            <option value="026">026 - کرج</option>
            <option value="028">028 - قزوین</option>
            <option value="031">031 - اصفهان</option>
            <option value="034">034 - کرمان</option>
            <option value="035">035 - یزد</option>
            <option value="038">038 - شهرکرد</option>
            <option value="041">041 - تبریز</option>
            <option value="044">044 - ارومیه</option>
            <option value="045">045 - اردبیل</option>
            <option value="054">054 - زاهدان</option>
            <option value="056">056 - بجنورد</option>
            <option value="058">058 - بیرجند</option>
            <option value="061">061 - اهواز</option>
            <option value="066">066 - لرستان</option>
            <option value="071">071 - شیراز</option>
            <option value="074">074 - کهگیلویه و بویراحمد</option>
            <option value="076">076 - بندرعباس</option>
            <option value="077">077 - بوشهر</option>
            <option value="081">081 - همدان</option>
            <option value="083">083 - کرمانشاه</option>
            <option value="084">084 - ایلام</option>
            <option value="086">086 - اراک</option>
            <option value="087">087 - سنندج</option>
        </select>
        <input type="text" id="hp" name="hp" placeholder="Home Phone" class="form-control" value="{{ user.hp }}" />
    </div>
    <div class="mb-3">
        <label>Department</label>
        <select id="d" name="d" class="form-control" required autocomplete="off">
            <option value="" disabled selected>انتخاب کنید</option>
            <option value="فنی و مهندسی">فنی و مهندسی</option>
            <option value="علوم پایه">علوم پایه</option>
            <option value="دامپزشکی">دامپزشکی</option>
            <option value="ادبیات و اقتصاد">ادبیات و اقتصاد</option>
        </select>
    </div>
    <div class="mb-3">
        <label>Major</label>
        <select id="m" name="m" class="form-control" required autocomplete="off">
            <option value="" disabled selected>ابتدا دانشکده را انتخاب کنید</option>
        </select>
    </div>
    <div class="mb-3">
        <label>Married</label>
        <select name="ma" class="form-control">
            <option value="Married" {% if user.ma == 'Married' %}selected{% endif %}>Married</option>
            <option value="not Married" {% if user.ma == 'not Married' %}selected{% endif %}>not Married</option>
        </select>
    </div>
    <div class="mb-3">
        <label>National ID</label>
        <input type="text" id="nid" name="nid" placeholder="National ID" class="form-control" value="{{ user.nid }}" />
        <div id="error-message4" class="text-danger"></div>
    </div>
    <div class="mb-3">
        <label>Subjects</label>
        <input type="text" name="scid" placeholder="Subjects" class="form-control" value="{{ user.scid }}" />
    </div>
    <div class="mb-3">
        <label>Professor IDs</label>
        <select name="lids" class="form-control">
            <option value="" disabled selected>انتخاب کنید</option>
            <option value="professor1" {% if user.lids == 'professor1' %}selected{% endif %}>professor1</option>
            <option value="professor2" {% if user.lids == 'professor2' %}selected{% endif %}>professor2</option>
            <option value="professor3" {% if user.lids == 'professor3' %}selected{% endif %}>professor3</option>
            <option value="professor4" {% if user.lids == 'professor4' %}selected{% endif %}>professor4</option>
            <option value="professor5" {% if user.lids == 'professor5' %}selected{% endif %}>professor5</option>
            <option value="professor6" {% if user.lids == 'professor6' %}selected{% endif %}>professor6</option>
        </select>
    </div>
    <input type="submit" value="Update" class="btn btn-primary mb-3" />
    <a href="/">home</a>
</form>
{% endblock content %}
